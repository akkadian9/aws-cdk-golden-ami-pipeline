{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "access-analyzer:List*",
                "access-analyzer:Get*",
                "access-analyzer:ValidatePolicy",
                "applicationinsights:List*",
                "cloudformation:List*",
                "cloudformation:Get*",
                "cloudformation:Describe*",
                "cloudformation:EstimateTemplateCost",
                "cloudformation:CreateStack",
                "cloudformation:DeleteStack",
                "cloudformation:DescribeStackEvents",
                "cloudformation:DescribeStacks",
                "cloudformation:GetTemplateSummary",
                "cloudformation:SetStackPolicy",
                "cloudformation:ValidateTemplate",
                "cloudformation:UpdateStack",
                "cloudtrail:Describe*",
                "cloudtrail:Get*",
                "cloudtrail:LookupEvents",
                "codeartifact:Describe*",
                "codeartifact:Get*",
                "codeartifact:List*",
                "codebuild:BatchGet*",
                "codebuild:List*",
                "codecommit:BatchGet*",
                "codecommit:Get*",
                "codecommit:List*",
                "codecommit:GitPull",
                "codecommit:DescribePullRequestEvents",
                "codecommit:EvaluatePullRequestApprovalRules",
                "codepipeline:Get*",
                "codepipeline:List*",
                "config:Describe*",
                "config:Get*",
                "config:List*",
                "dynamodb:List*",
                "dynamodb:Describe*",
                "dynamodb:Get*",
                "dynamodb:BatchGetItem",
                "dynamodb:ConditionCheckItem",
                "dynamodb:PartiQLSelect",
                "dynamodb:Scan",
                "dynamodb:Query",
                "ec2:Describe*",
                "ec2:List*",
                "ecr-public:Describe*",
                "ecr-public:Get*",
                "ecr:Get*",
                "ecr:Describe*",
                "ecr:BatchGetRepositoryScanningConfiguration",
                "events:Describe*",
                "events:List*",
                "health:DescribeEventAggregates",
                "kms:DescribeKey",
                "kms:ListAliases",
                "lambda:Get*",
                "lambda:List*",
                "logs:Describe*",
                "logs:Get*",
                "logs:StartQuery",
                "cloudwatch:Describe*",
                "cloudwatch:Get*",
                "organizations:DescribeOrganization",
                "organizations:ListDelegatedAdministrators",
                "resource-groups:ListGroups",
                "s3:Get*",
                "s3:List*",
                "servicecatalog:Describe*",
                "servicecatalog:List*",
                "servicecatalog:Get*",
                "servicecatalog:Search*",
                "sns:Get*",
                "sns:List*",
                "ssm:DescribeParameter*",
                "ssm:GetParameter*",
                "ssm:List*",
                "states:Get*",
                "states:Describe*",
                "states:List*",
                "support:DescribeTrustedAdvisorChecks",
                "xray:Get*",
                "sts:GetCallerIdentity",
                "sts:GetSessionToken",
                "tag:GetResources",
                "logs:FilterLogEvents",
                "schemas:ListDiscoverers"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "ReadAccess"
        },
        {
            "Action": [
                "cloudformation:Create*",
                "cloudformation:Delete*",
                "cloudformation:ExecuteChangeSet*",
                "cloudformation:Update*",
                "codebuild:CreateProject",
                "codebuild:DeleteProject",
                "codebuild:UpdateProject",
                "codebuild:RetryBuild",
                "codecommit:Update*",
                "codecommit:Create*",
                "codecommit:Delete*",
                "codecommit:Merge*",
                "codecommit:GitPush",
                "codecommit:PutFile",
                "codecommit:PutRepositoryTriggers",
                "codecommit:TagResource",
                "codecommit:UntagResource",
                "codecommit:BatchAssociateApprovalRuleTemplateWithRepositories",
                "codecommit:PostCommentForPullRequest",
                "codepipeline:DisableStageTransition",
                "codepipeline:EnableStageTransition",
                "codepipeline:PutApprovalResult",
                "codepipeline:RetryStageExecution",
                "codepipeline:StartPipelineExecution",
                "codepipeline:StopPipelineExecution",
                "codepipeline:DeletePipeline",
                "events:DeleteRule",
                "events:Put*",
                "events:RemoveTargets",
                "kms:CreateGrant",
                "kms:Decrypt",
                "kms:Encrypt",
                "kms:GenerateDataKey",
                "lambda:CreateFunction*",
                "lambda:DeleteFunction*",
                "lambda:RemovePermission*",
                "lambda:Update*",
                "s3:CreateBucket",
                "s3:Put*",
                "servicecatalog:ProvisionProduct",
                "servicecatalog:TerminateProvisionedProduct",
                "servicecatalog:UpdateProvisionedProduct",
                "sns:CreateTopic*",
                "sns:SetTopicAttributes*",
                "sns:Subscribe*",
                "ssm:PutParameter",
                "ssm:DeleteParameter",
                "states:Start*",
                "states:Stop*",
                "states:DeleteStateMachine*",
                "logs:Delete*",
                "logs:Create*",
                "logs:Put*",
                "events:CreateEventBus",
                "events:DeleteEventBus",
                "servicecatalog:AssociatePrincipalWithPortfolio",
                "lambda:InvokeFunction"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "WriteAccess"
        },
        {
            "Action": [
                "iam:Get*",
                "iam:List*"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "IAMReadAccess"
        },
        {
            "Action": [
                "servicecatalog:CreateProduct",
                "servicecatalog:CreatePortfolio",
                "servicecatalog:CreatePortfolioShare",
                "servicecatalog:CreateProvisioningArtifact",
                "servicecatalog:DisassociatePrincipalFromPortfolio",
                "servicecatalog:DisassociateProductFromPortfolio",
                "servicecatalog:DeletePortfolio"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "ServiceCatalogAccess"
        },
        {
            "Action": [
                "iam:PassRole"
            ],
            "Resource": [
                "arn:aws:iam::*:role/CICDAWSCloudFormationStackSetAdministrationRole*",
                "arn:aws:iam::*:role/*-day0-infra-codebuild-role-*",
                "arn:aws:iam::*:role/*CloudformationStackSetExecution-*",
                "arn:aws:iam::*:role/*CloudFormationStackSetExecutionRole-*",
                "arn:aws:iam::*:role/*-lambda-role"
            ],
            "Effect": "Allow",
            "Sid": "IAMPassRoleForPipelineRoles"
        },
        {
            "Action": [
                "iam:AssumeRole"
            ],
            "Resource": [
                "arn:aws:iam::*:role/CICDAWSCloudFormationStackSetAdministrationRole*",
                "arn:aws:iam::*:role/*-day0-infra-codebuild-role-*",
                "arn:aws:iam::*:role/*CloudformationStackSetExecution-*",
                "arn:aws:iam::*:role/*-lambda-role"
            ],
            "Effect": "Allow",
            "Sid": "TempIAMAssumeRoleForPipelineRoles"
        },
        {
            "Action": [
                "iam:CreatePolicy",
                "iam:DeletePolicy"
            ],
            "Resource": [
                "arn:aws:iam::*:policy/*-day0-infra-*",
                "arn:aws:iam::*:policy/*-intake-cross-account-policy"
            ],
            "Effect": "Allow",
            "Sid": "GrantIAMPolicies"
        },
        {
            "Action": [
                "iam:CreateRole",
                "iam:DeleteRole",
                "iam:AttachRolePolicy",
                "iam:PutRolePolicy",
                "iam:DeletePolicy",
                "iam:DetachRolePolicy",
                "iam:DeleteRolePolicy"
            ],
            "Resource": [
                "arn:aws:iam::*:role/*-intake-cross-account-role",
                "arn:aws:iam::*:role/*-day0-infra-*",
                "arn:aws:iam::*:role/*-lambda-role"
            ],
            "Effect": "Allow",
            "Sid": "GrantIAMRoles"
        }
    ]
}